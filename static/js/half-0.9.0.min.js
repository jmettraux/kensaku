/* half-0.9.0.min.js | MIT license: http://github.com/jmettraux/half/LICENSE.txt */
var Half=function(){var p=this,h={},n=function(){};n.prototype=h;h.link=function(b,d){if(void 0!==this._links){var a=b,e=this._links[b];if(b.match(/^#/))for(var c in this._links)if(!(0>c.indexOf(b,c.length-b.length))){a=c;e=this._links[c];break}if(!e)return{rel:b};c={};for(var f in e)c[f]=e[f];c.rel=a;c.uri=c.href;if(c.templated){if(a=c.uri.match(/(.+)\{\?([^\}]+)\}$/))for(c.uri=a[1],a=a[2].split(","),e=0;e<a.length;e++){f=a[e];var g=d[f];void 0!==g&&(c.uri+=1<c.uri.indexOf("?")?"&":"?",c.uri=c.uri+
f+"="+g)}for(f in d)c.uri=c.uri.replace("{"+f+"}",d[f])}return c}};h.uri=function(b,d){return(this.link(b,d)||{}).uri};h.get=function(b,d,a,e){var c=l("GET",arguments);k(this.link(c.rel,c.params),"GET",null,c.onSuccess,c.onError)};h.post=function(b,d,a,e,c){var f=l("POST",arguments);k(this.link(f.rel,f.params),"POST",f.data,f.onSuccess,f.onError)};h.delete=function(b,d,a,e){var c=l("DELETE",arguments);k(this.link(c.rel,c.params),"DELETE",null,c.onSuccess,c.onError)};h.embeds=function(b){if(b=(this._embedded||
{})[b]){for(var d=[],a=0,e=b.length;a<e;a++)d.push(Half.wrap(b[a]));return d}};this.wrap=function(b){var d=new n,a;for(a in b)d[a]=b[a];return d};this.expand=function(b,d){if(b.match(/^https?:\/\//))return b;void 0===d&&(d=window.location.href);if(d.match(/^file:/))return"http://localhost:4567/"+b;b=b.split("/");var a=d.match(/^(https?:\/\/[^\/]+)([^\?]*)/),e=a[1],a=a[2].split("/");a.pop();if(""===b[0])a=[];else for(;".."===b[0];)a.pop(),b.shift();return e+a.concat(b).join("/")};this.go=function(b,
d,a){var e=!0,c=void 0;void 0===d&&(e=!1,d=function(a){c=a},a=function(){});b={uri:p.expand(b)};k(b,"GET",null,d,a,e);return c};var l=function(b,d){for(var a={},e=0,c=d.length;e<c;e++){var f=!1,g=typeof d[e];"string"===g?(a.rel&&(f=!0),a.rel=d[e]):"object"===g?(a.data&&(f=!0),a.params?a.data=d[e]:a.params=d[e]):"function"===g?(a.onError&&(f=!0),a.onSuccess?a.onError=d[e]:a.onSuccess=d[e]):"boolean"===g&&(a.async&&(f=!0),a.async=d[e]);if(f)throw Error("args mismatch (at '"+d[e]+"')");}"POST"===b&&
(a.params&&!a.data)&&(a.data=a.params,a.params=null);if("POST"===b&&!a.data)throw Error("missing POST data arg");return a},q=function(b,d){if(!b.fields)return d;for(var a=0,e=b.fields.length;a<e;a++){var c=b.fields[a],f=d[c.name],f=void 0===f||null===f;if(c.required&&f)throw Error("field '"+c.name+"' required");f&&c["default"]&&(d[c.name]=c["default"]);c.value&&(d[c.name]=c.value)}return d},m=function(b,d){b&&b({text:d,data:{error:d},status:"error"})},k=function(b,d,a,e,c,f){if(void 0===b.uri)return m(c,
"unknown rel '"+b.rel+"'");if(0<b.uri.indexOf("{"))return m(c,"not fully expanded: "+b.uri);void 0===f&&(f=!0);d={type:d,url:b.uri,async:f,success:function(a){e(Half.wrap(a))},error:function(a,b,d){if(c){var e=a.responseText,f=void 0;try{f=JSON.parse(e)}catch(g){}c({text:e,data:f,jqxhr:a,status:b,err:d})}}};if(a){d.contentType="application/json; charset=utf-8";try{a=q(b,a)}catch(g){return m(c,g.message)}d.data=JSON.stringify(a)}$.ajax(d)};return this}.apply({});

/* compressed from commit 6d14155 on 2013-08-27 06:15:54 +0900 */
